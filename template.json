{
  "variables": {
    "home": "{{env `HOME`}}"
  },
  "builders": [
    {
      "type": "virtualbox-ovf",
      "headless": false,
      "source_path": "{{user `home`}}/.vagrant.d/boxes/debian-VAGRANTSLASH-jessie64/8.7.0/virtualbox/box.ovf",
      "ssh_username": "vagrant",
      "ssh_password": "vagrant",
      "ssh_private_key_file":"vendor/vagrant/keys/vagrant",
      "vboxmanage": [
        ["modifyvm", "{{.Name}}", "--memory", "1024"],
        ["modifyvm", "{{.Name}}", "--cpus", "2"]
      ],
      "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now"
      }
  ],
  "provisioners": [
    {
      "type": "shell",
      "execute_command": "echo 'packer' | sudo -S sh -c '{{ .Vars }} {{ .Path }}'",
      "script": "scripts/install-virtualbox-guest-additions.sh"
    },
    {
      "type": "file",
      "source": "vendor/chef/chef.deb",
      "destination": "/tmp/chef.deb"
    },
    {
      "type": "chef-solo",
      "install_command": "echo 'packer' | sudo -S dpkg -i /tmp/chef.deb",
      "cookbook_paths": ["cookbooks/wp.dev/vendor/cookbooks"],
      "run_list": ["wp.dev::default"]
    }
  ],
  "post-processors": [
    [
      {
        "type": "vagrant",
        "keep_input_artifact": false,
        "compression_level": 9
      }
    ]
  ]
}
